<template id="bindings-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Edit Param</span>
                        <span v-if="!original">New Param</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="bindings-dialog-binding">Binding</label>
                        <div class="input-group">
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                    <span v-if="getStrategy() == 'eval'">Eval </span>
                                    <span v-if="getStrategy() != 'eval'">Interpolate </span>
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li :class="{ 'active': getStrategy() == 'eval' }"><a href="#" @click="setStrategy('eval')">Eval</a></li>
                                    <li :class="{ 'active': getStrategy() != 'eval' }"><a href="#" @click="setStrategy('interpolate')">Interpolate</a></li>
                                </ul>
                            </div>
                            <input class="form-control" type="text" id="bindings-dialog-binding" v-model="current.binding.expression" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="domains-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog modal-lg">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Настройки домена</span>
                        <span v-if="!original">Новый домен</span>
                        <span>&gt;</span>
                        <span v-if="isActive('main')">Основное</span>
                        <span v-if="isActive('settings')">Настроки</span>
                    </h4>
                </div>
                <div class="modal-body" style="height: 500px;">
                    <div class="row">
                        <div class="col-xs-3">
                            <ul class="nav nav-pills nav-stacked">
                                <li :class="{ 'active': isActive('main') }"><a href="#" @click="activate('main')">Основное</a></li>
                                <li :class="{ 'active': isActive('settings') }"><a href="#" @click="activate('settings')">Настройки</a></li>
                            </ul>
                        </div>
                        <div class="col-xs-9">
                            <div class="tab-content" style="overflow: auto">
                                <div class="tab-pane" :class="{ 'active': isActive('main') }">
                                    <div class="form-group">
                                        <label for="dialog-domain-name">Имя</label>
                                        <input class="form-control" type="text" id="dialog-domain-name" required="true" v-model="current.name" />
                                    </div>
                                    <div class="form-group">
                                        <label for="dialog-page-title">Заголовок</label>
                                        <input class="form-control" type="text" id="dialog-page-title" name="title" required="true" v-model="current.title.value" />
                                    </div>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('settings') }">
                                    <domains-settings :items.sync="current.resource.params"></domains-settings>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="domains-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 60%">Имя</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ title: {}, resource: { params: [] }})">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>
                        <span class="label label-success">{{ item.name }}</span>
                        &nbsp;
                        <span>{{ item.title.value }}</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="domains-settings-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Редактирование параметра</span>
                        <span v-if="!original">Новый параметр</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="domains-settings-dialog-name">Имя</label>
                        <input class="form-control" type="text" id="domains-settings-dialog-name" required="true" v-model="current.name" />
                    </div>
                    <div class="form-group">
                        <label for="domains-settings-dialog-value">Значение</label>
                        <div class="input-group">
                            <input class="form-control" type="text" id="domains-settings-dialog-value" v-model="current.value" />
                            <div class="input-group-btn">
                                <bindings :model.sync="current" inline-template>
                                    <button type="button" class="btn btn-default" @click="open">...</button>
                                </bindings>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="domains-settings-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Имя</th>
                    <th style="width: 40%">Значение</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ value: null, binding: null})">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>{{ item.name }}</td>
                    <td>
                        <span>{{ item.value }}</span>
                        <span v-if="item.value">&nbsp;</span>
                        <span v-if="item.binding" class="label label-primary">Связано</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="domains-settings">

    <domains-settings-list :items.sync="items"></domains-settings-list>

</template>

<template id="domains">

    <domains-list :items.sync="items"></domains-list>

</template>

<template id="pages-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog modal-lg">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Настройки страницы</span>
                        <span v-if="!original">Новая страница</span>
                        <span>&gt;</span>
                        <span v-if="isActive('main')">Основное</span>
                        <span v-if="isActive('sources')">Источники</span>
                        <span v-if="isActive('storages')">Данные</span>
                        <span v-if="isActive('settings')">Настроки</span>
                        <span v-if="isActive('metas')">Мета</span>
                    </h4>
                </div>
                <div class="modal-body" style="height: 500px;">
                    <div class="row">
                        <div class="col-xs-3">
                            <ul class="nav nav-pills nav-stacked">
                                <li :class="{ 'active': isActive('main') }"><a href="#" @click="activate('main')">Основное</a></li>
                                <li :class="{ 'active': isActive('sources') }"><a href="#" @click="activate('sources')">Источники</a></li>
                                <li :class="{ 'active': isActive('storages') }"><a href="#" @click="activate('storages')">Данные</a></li>
                                <li :class="{ 'active': isActive('settings') }"><a href="#" @click="activate('settings')">Настройки</a></li>
                                <li :class="{ 'active': isActive('metas') }"><a href="#" @click="activate('metas')">Мета</a></li>
                            </ul>
                        </div>
                        <div class="col-xs-9">
                            <div class="tab-content" style="min-height: 450px; max-height: 450px; overflow: auto;">
                                <div class="tab-pane" :class="{ 'active': isActive('main') }">
                                    <div class="form-group">
                                        <label for="dialog-page-name">Имя</label>
                                        <input class="form-control" type="text" id="dialog-page-name" required="true" v-model="current.name" />
                                    </div>
                                    <div class="form-group">
                                        <label for="dialog-page-title">Заголовок</label>
                                        <input class="form-control" type="text" id="dialog-page-title" name="title" required="true" v-model="current.title.value" />
                                    </div>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('sources') }">
                                    <pages-sources :items.sync="current.sources"></pages-sources>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('storages') }">
                                    <storages :items.sync="current.storages"></storages>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('settings') }">
                                    <pages-settings :items.sync="current.resource.params"></pages-settings>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('metas') }">
                                    <pages-metas :items.sync="current.metas"></pages-metas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="pages-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 60%">Страница</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ title: {}, resource: { params: [] }, sources: [], widgets: [], metas: []})">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>
                        <span class="label label-success">{{ item.name }}</span>
                        &nbsp;
                        <span>{{ item.title.value }}</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="pages-metas-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Редактирование параметра</span>
                        <span v-if="!original">Новый параметр</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="pages-metas-dialog-name">Имя</label>
                        <input class="form-control" type="text" id="pages-metas-dialog-name" required="true" v-model="current.name" />
                    </div>
                    <div class="form-group">
                        <label for="pages-metas-dialog-value">Значение</label>
                        <div class="input-group">
                            <input class="form-control" type="text" id="pages-metas-dialog-value" v-model="current.value" />
                            <div class="input-group-btn">
                                <bindings :model.sync="current" inline-template>
                                    <button type="button" class="btn btn-default" @click="open">...</button>
                                </bindings>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="pages-metas-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Имя</th>
                    <th style="width: 40%">Значение</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ value: null, binding: null})">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>{{ item.name }}</td>
                    <td>
                        <span>{{ item.value }}</span>
                        <span v-if="item.value">&nbsp;</span>
                        <span v-if="item.binding" class="label label-primary">Связано</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="pages-metas">

    <pages-metas-list :items.sync="items"></pages-metas-list>

</template>

<template id="pages-settings-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Редактирование параметра</span>
                        <span v-if="!original">Новый параметр</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="pages-settings-dialog-name">Имя</label>
                        <input class="form-control" type="text" id="pages-settings-dialog-name" required="true" v-model="current.name" />
                    </div>
                    <div class="form-group">
                        <label for="pages-settings-dialog-value">Значение</label>
                        <div class="input-group">
                            <input class="form-control" type="text" id="pages-settings-dialog-value" v-model="current.value" />
                            <div class="input-group-btn">
                                <bindings :model.sync="current" inline-template>
                                    <button type="button" class="btn btn-default" @click="open">...</button>
                                </bindings>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="pages-settings-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Имя</th>
                    <th style="width: 40%">Значение</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ value: null, binding: null})">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>{{ item.name }}</td>
                    <td>
                        <span>{{ item.value }}</span>
                        <span v-if="item.value">&nbsp;</span>
                        <span v-if="item.binding" class="label label-primary">Связано</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="pages-settings">

    <pages-settings-list :items.sync="items"></pages-settings-list>

</template>

<template id="pages">

    <div>
        <pages-list :items.sync="items" :globals.sync="globals"></pages-list>
    </div>

</template>

<template id="schemes-dialog">
	<div class="ge ge-modal modal modal-center" role="dialog">
		<div class="modal-dialog modal-lg">
			<form class="modal-content"
				@submit.prevent="submit"
				@reset.prevent="reset"
			>
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
					<h4 class="modal-title">
						<span v-if="original" class="label label-primary">{{ original.name }}</span>
						<span v-if="original">&nbsp;Настройки схемы</span>
						<span v-if="!original">Новая схема</span>
                        <span>&gt;</span>
                        <span v-if="isActive('main')">Основное</span>
                        <span v-if="isActive('settings')">Настроки</span>
					</h4>
				</div>
				<div class="modal-body" style="height: 500px;">
                    <div class="row">
                        <div class="col-xs-3">
                            <ul class="nav nav-pills nav-stacked">
                                <li :class="{ 'active': isActive('main') }"><a href="#" @click="activate('main')">Основное</a></li>
                                <li :class="{ 'active': isActive('settings') }"><a href="#" @click="activate('settings')">Настройки</a></li>
                            </ul>
                        </div>
                        <div class="col-xs-9">
                            <div class="tab-content" style="overflow: auto">
                                <div class="tab-pane" :class="{ 'active': isActive('main') }">
                                    <div class="form-group">
                						<label for="dialog-schema-name">Имя</label>
                						<input class="form-control" type="text" id="dialog-schema-name" required="true" v-model="current.name" />
                					</div>
                					<div class="form-group">
                						<label for="dialog-schema-url">URL</label>
                						<input class="form-control" type="text" id="dialog-schema-url" name="url" required="true" v-model="current.url" />
                					</div>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('settings') }">
                                    <schemes-settings :items.sync="current.resource.params"></schemes-settings>
                                </div>
                            </div>
                        </div>
                    </div>
				</div>
				<div class="modal-footer">
					<button type="reset" class="btn btn-default">Отменить</button>
					<button type="submit" class="btn btn-primary">Сохранить</button>
				</div>
			</form>
		</div>
	</div>
</template>

<template id="schemes-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 60%">Схема</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ resource: { params: [] }})">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>
                        <span class="label label-success">{{ item.name }}</span>
                        &nbsp;
                        <a :href="item.url">{{ item.url }}</a>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="schemes-settings-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Редактирование параметра</span>
                        <span v-if="!original">Новый параметр</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="schemes-settings-dialog-name">Имя</label>
                        <input class="form-control" type="text" id="schemes-settings-dialog-name" required="true" v-model="current.name" />
                    </div>
                    <div class="form-group">
                        <label for="schemes-settings-dialog-value">Значение</label>
                        <div class="input-group">
                            <input class="form-control" type="text" id="schemes-settings-dialog-value" v-model="current.value" />
                            <div class="input-group-btn">
                                <bindings :model.sync="current" inline-template>
                                    <button type="button" class="btn btn-default" @click="open">...</button>
                                </bindings>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="schemes-settings-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Имя</th>
                    <th style="width: 40%">Значение</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ value: null, binding: null})">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>{{ item.name }}</td>
                    <td>
                        <span>{{ item.value }}</span>
                        <span v-if="item.value">&nbsp;</span>
                        <span v-if="item.binding" class="label label-primary">Связано</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="schemes-settings">

    <schemes-settings-list :items.sync="items"></schemes-settings-list>

</template>

<template id="schemes">

    <schemes-list :items.sync="items"></schemes-list>

</template>

<template id="settings-dialog">
    <div class="ge ge-modal modal modal-center">
        <div class="modal-dialog modal-lg">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span>Настройки сайта</span>
                        <span>&gt;</span>
                        <span v-if="isActive('domains')">Домены</span>
                        <span v-if="isActive('pages')">Страницы</span>
                        <span v-if="isActive('schemes')">Схемы</span>
                        <span v-if="isActive('widgets')">Виджеты</span>
                </div>
                <div class="modal-body" style="height: 500px;">
                    <div class="row">
                        <div class="col-xs-3">
                            <ul class="nav nav-pills nav-stacked">
                                <li :class="{ 'active': isActive('domains') }"><a href="#" @click="activate('domains')">Домены</a></li>
                                <li :class="{ 'active': isActive('pages') }"><a href="#" @click="activate('pages')">Страницы</a></li>
                                <li :class="{ 'active': isActive('schemes') }"><a href="#" @click="activate('schemes')">Схемы</a></li>
                                <li :class="{ 'active': isActive('widgets') }"><a href="#" @click="activate('widgets')">Виджеты</a></li>
                            </ul>
                        </div>
                        <div class="col-xs-9">
                            <div class="tab-content" style="overflow: auto">
                                <div class="tab-pane" :class="{ 'active': isActive('domains') }">
                                    <domains :items.sync="current.domains" :globals.sync="globals"></domains>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('pages') }">
                                    <pages :items.sync="current.pages" :globals.sync="globals"></pages>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('schemes') }">
                                    <schemes :items.sync="current.schemes" :globals.sync="globals"></schemes>
                                </div>
                                <div class="tab-pane" :class="{ 'active': isActive('widgets') }">
                                    <widgets :items.sync="current.widgets" :globals.sync="globals"></widgets>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="params-bindings-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog modal-lg">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Edit Param</span>
                        <span v-if="!original">New Param</span>
                        <span>&gt;</span>
                        <span v-for="tab in context.prop.tabs" v-if="isActive(tab.name)">{{ tab.title }}</span>
                        <span v-if="isActive('binding')">Binding</span>
                    </h4>
                </div>
                <div class="modal-body" style="height: 500px;">
                    <div class="row">
                        <div class="col-xs-3">
                            <ul class="nav nav-pills nav-stacked">
                                <li :class="{ 'active': isActive('binding') }"><a href="#" @click="activate('binding')">Binding</a></li>
                                <li v-for="tab in context.prop.tabs" :class="{ 'active': isActive(tab.name) }"><a href="#" @click="activate(tab.name)">{{ tab.title }}</a></li>
                            </ul>
                        </div>
                        <div class="col-xs-9">
                            <div class="tab-content" style="min-height: 450px; max-height: 450px; overflow: auto;">
                                <div class="tab-pane" :class="{ 'active': isActive('binding') }">
                                    <div class="form-group">
                                        <label for="bindings-dialog-binding">Биндинг</label>
                                        <div class="input-group">
                                            <div class="input-group-btn">
                                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                                    <span v-if="getStrategy() == 'eval'">Eval </span>
                                                    <span v-if="getStrategy() == 'interpolate'">Interpolate </span>
                                                    <span v-if="getStrategy() == 'wire'">Wire </span>
                                                    <span class="caret"></span>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li :class="{ 'active': getStrategy() == 'eval' }"><a href="#" @click="setStrategy('eval')">Eval</a></li>
                                                    <li :class="{ 'active': getStrategy() == 'interpolate' }"><a href="#" @click="setStrategy('interpolate')">Interpolate</a></li>
                                                    <li v-if="context.prop.variable" :class="{ 'active': getStrategy() == 'wire' }"><a href="#" @click="setStrategy('wire')">Wire</a></li>
                                                </ul>
                                            </div>
                                            <input class="form-control" type="text" id="bindings-dialog-binding" v-model="current.binding.expression" />
                                        </div>
                                    </div>
                                </div>
                                <div v-for="tab in context.prop.tabs" class="tab-pane" :class="{ 'active': isActive(tab.name) }">
                                    <params :items.sync="items" :globals.sync="globals" :owner.sync="context.prop" :tab="tab.name"></params>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="params-list">
    <div>
        <div v-for="item in items" v-if="item.prop.tab == tab">
            <params-string v-if="item.prop.type == 'string'" :id="'pages-widgets-dialog-props-' + $index"
                :item.sync="item"
                :globals.sync="globals"
            ></params-string>
            <params-rich v-if="item.prop.type == 'rich'" :id="'pages-widgets-dialog-props-' + $index"
                :item.sync="item"
                :globals.sync="globals"
            ></params-rich>
            <params-source v-if="item.prop.type == 'source'" :id="'pages-widgets-dialog-props-' + $index"
                :item.sync="item"
                :globals.sync="globals"
            ></params-source>
            <params-multiple v-if="item.prop.type == 'multiple'" :id="'pages-widgets-dialog-props-' + $index"
                :item.sync="item"
                :globals.sync="globals"
            ></params-multiple>
        </div>
    </div>
</template>

<template id="params-multiple-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog modal-lg">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Редактирование параметра</span>
                        <span v-if="!original">Новый параметр</span>
                        <span>&gt;</span>
                        <span v-for="tab in context.prop.tabs" v-if="isActive(tab.name)">{{ tab.title }}</span>
                    </h4>
                </div>
                <div class="modal-body" style="height: 500px;">
                    <div class="row">
                        <div class="col-xs-3">
                            <ul class="nav nav-pills nav-stacked">
                                <li v-for="tab in context.prop.tabs" :class="{ 'active': isActive(tab.name) }"><a href="#" @click="activate(tab.name)">{{ tab.title }}</a></li>
                            </ul>
                        </div>
                        <div class="col-xs-9">
                            <div class="tab-content" style="min-height: 450px; max-height: 450px; overflow: auto;">
                                <div v-for="tab in context.prop.tabs" class="tab-pane" :class="{ 'active': isActive(tab.name) }">
                                    <params :items.sync="items" :globals.sync="globals" :owner.sync="context.prop" :tab="tab.name"></params>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="params-multiple-editor">
    <div>
        <params-multiple-list
            :items.sync="items"
            :prop.sync="prop"
            :param.sync="param"
            :globals.sync="globals"
        ></params-multiple-list>
    </div>
</template>

<template id="params-multiple-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th style="width: 80%" colspan="2">{{ prop.title }}</th>
                    <th>
                        <div class="pull-right">
                            <a class="btn btn-xs btn-primary" @click="create({}, { prop: prop })">Add</a>
                            <params-bindings :model.sync="param" :context="{ prop: prop }" inline-template>
                                <a class="btn btn-xs btn-default" @click="open()">Bindings</a>
                            </params-bindings>
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>{{ getLabel(item) }}</td>
                    <td>
                        <div class="pull-right">
                            <a class="btn btn-xs btn-default" @click="update(item, { prop: prop })">Edit</a>
                            <a class="btn btn-xs btn-danger" @click="remove(item, { prop: prop })">Remove</a>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="params-multiple">
    <params-multiple-editor
        :prop.sync="item.prop"
        :param.sync="item.param"
        :items.sync="item.param.value"
        :globals.sync="globals"
    ></params-multiple-editor>
</template>

<template id="params-rich">
    <div class="form-group">
        <label for="{{ id }}">{{ item.prop.title }}</label>
        <div class="input-group">
            <textarea class="form-control" id="{{ id }}" v-rich="item.param.value"></textarea>
            <div class="input-group-btn">
                <params-bindings :model.sync="item.param" :context="{ prop: item.prop }" inline-template>
                    <button type="button" class="btn btn-default" @click="open()">...</button>
                </params-bindings>
            </div>
        </div>
    </div>
</template>

<template id="params-source">
    <div class="form-group">
        <label for="{{ id }}">{{ item.prop.title }}</label>
        <div class="input-group">
            <div class="input-group-btn">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                    <span><span class="label label-success">{{ param._source }}</span> {{ param._source.name }}</span>
                    &nbsp;
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li v-for="s in globals.sources">
                        <a href="#" @click.prevent="selectSource(s)">
                            <span><span class="label label-success">{{ s.name }}</span> {{ s.url }}</span>
                        </a>
                    </li>
                </ul>
            </div>
            <span class="form-control">{{ item.param.value }}</span>
            <div class="input-group-btn">
                <button type="button" class="btn btn-default">...</button>
            </div>
        </div>
    </div>
</template>

<template id="params-string">
    <div class="form-group">
        <label for="{{ id }}">{{ item.prop.title }}</label>
        <div class="input-group">
            <input class="form-control" type="text" id="{{ id }}" v-model="item.param.value" />
            <div class="input-group-btn">
                <params-bindings :model.sync="item.param" :context="{ prop: item.prop }" inline-template>
                    <button type="button" class="btn btn-default" @click="open()">...</button>
                </params-bindings>
            </div>
        </div>
    </div>
</template>

<template id="params">
    <div>
        <params-list :items.sync="items" :globals.sync="globals" :owner.sync="owner" :tab="tab"></params-list>
    </div>
</template>

<template id="storages-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Edit Storage</span>
                        <span v-if="!original">New Storage</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="storages-dialog-name">Name</label>
                        <input class="form-control" type="text" id="storages-dialog-name" required="true" v-model="current.name" />
                    </div>
                    <div class="form-group">
                        <label for="storages-dialog-params">Variables</label>
                        <div>
                            <storages-variables :items.sync="current.variables"></storages-variables>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="storages-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Name</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ variables: [] })">Create</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>
                        <span class="label label-success">{{ item.name }}</span>
                        &nbsp;
                        <span>{{ item.url }}</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Edit</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Remove</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="storages-variables-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Edit Variable</span>
                        <span v-if="!original">New Variable</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="storages-variables-dialog-name">Name</label>
                        <input class="form-control" type="text" id="storages-variables-dialog-name" required="true" v-model="current.name" />
                    </div>
                    <div class="form-group">
                        <label for="storages-variables-dialog-value">Value</label>
                        <div class="input-group">
                            <input class="form-control" type="text" id="storages-variables-dialog-value" v-model="current.value" />
                            <div class="input-group-btn">
                                <bindings :model.sync="current" inline-template>
                                    <button type="button" class="btn btn-default" @click="open">...</button>
                                </bindings>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="storages-variables-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Name</th>
                    <th style="width: 40%">Value</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ value: null, binding: null})">Add</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>{{ item.name }}</td>
                    <td>
                        <span>{{ item.value }}</span>
                        <span v-if="item.value">&nbsp;</span>
                        <span v-if="item.binding" class="label label-primary">Bound</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Edit</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Remove</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="storages-variables">

    <storages-variables-list :items.sync="items"></storages-variables-list>

</template>

<template id="storages">

    <storages-list :items.sync="items"></storages-list>

</template>

<template id="widgets-dialog">
	<div class="modal modal-center" role="dialog">
		<div class="ge ge-modal modal-dialog modal-lg">
			<form class="modal-content"
				@submit.prevent="submit"
				@reset.prevent="reset"
			>
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
					<h4 class="modal-title">
						<span v-if="original" class="label label-primary">{{ original.name }}</span>
						<span v-if="original">&nbsp;Настройки виджета</span>
						<span v-if="!original">Новый виджет</span>
					</h4>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<label for="dialog-widget-name">Имя</label>
						<input class="form-control" type="text" id="dialog-widget-name" required="true" v-model="current.name" />
					</div>
                    <div class="form-group">
						<label for="dialog-widget-name">Тип</label>
						<input class="form-control" type="text" id="dialog-widget-name" required="true" v-model="current.type" />
					</div>
				</div>
				<div class="modal-footer">
					<button type="reset" class="btn btn-default">Отменить</button>
					<button type="submit" class="btn btn-primary">Сохранить</button>
				</div>
			</form>
		</div>
	</div>
</template>

<template id="widgets-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 100%">Имя</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td><span class="label label-success">{{ item.provider.bundle }}/{{ item.name }}</span> {{ item.title }}</td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="widgets">

    <widgets-list :items.sync="items"></widgets-list>

</template>

<template id="shell-actions">
    <section class="ge ge-actions">
        <div class="pull-left">
            <button type="button" class="btn btn-default" @click="trigger('push')">
                <span class="glyphicon glyphicon-cloud-upload"></span>
                <span>Store Changes</span>
            </button>
            <button type="button" class="btn btn-default" @click="trigger('pull')">
                <span class="glyphicon glyphicon-cloud-download"></span>
                <span>Discard Changes</span>
            </button>
        </div>
        <div class="pull-right">

            <button type="button" class="btn btn-default" @click="zoom('in')">
                <span class="glyphicon glyphicon-zoom-in"></span>
                <span>Zoom in</span>
            </button>
            <button type="button" class="btn btn-default" @click="zoom('out')">
                <span class="glyphicon glyphicon-zoom-out"></span>
                <span>Zoom out</span>
            </button>


            <!--
            <button type="button" class="btn btn-default">Page Settings</button>
            <button type="button" class="btn btn-default">Add Source</button>
            -->
        </div>
    </section>
</template>

<template id="shell-brand">
    <section class="ge ge-brand">
        <a href="#"></a>
    </section>
</template>

<template id="shell-container">

    <section class="ge ge-container">
        <shell-page
            :globals.sync="globals"
            :settings.sync="settings"
            :page.sync="page"
            :items.sync="page.widgets"
        ></shell-page>
    </section>

</template>

<template id="shell-categories">
    <section class="ge ge-categories">
        <div v-for="category in categories">
            <h5>
                <span>{{ category.title }}</span>
            </h5>
            <ul class="nav nav-pills nav-stacked">
                <li v-for="item in category.categories" :class="{ 'active': item == globals.selection.category }"><a href="#" @click="trigger('selectCategory', item)">{{ item.title }}</a></li>
            </ul>
        </div>
    </section>
</template>

<template id="shell-decorator-canvas">
    <div class="ge ge-widget" :class="{ 'ge-widget-selected': selected }">
        <div class="ge ge-content">
            <default-stack-canvas
                :globals.sync="globals"
                :page.sync="page"
                :data.sync="data"
                :storage.sync="storage"
                :children.sync="children"
                :editable.sync="true"
            ></default-stack-canvas>
        </div>
    </div>
</template>

<template id="shell-decorator-horisontal">
    <div class="ge ge-widget" :class="{ 'ge-widget-selected': selected, 'ignore-elements': editable }">
        <div class="ge ge-content">
            <div
                :is="widget.tag"
                v-ref:widget
                :page.sync="page"
                :data.sync="data"
                :storage.sync="storage"
                :bindings.sync="bindings"
                :children.sync="children"
                :editable.sync="selected"
            ></div>
        </div>
        <div class="ge ge-overlay" v-if="$route.private && editable">
            <div class="ge ge-overlay-left">
                <a href="#" v-if="!selected" @click.stop.prevent="selectTarget()" class="label label-success">Unlock</a>
                <a href="#" v-if="selected" @click.stop.prevent="unselectTarget()" class="label label-success">Lock</a>
            </div>
            <div class="ge ge-overlay-right">
                <a href="#" v-if="!selected" @click.stop.prevent="showSettings()" class="label label-primary">Settings</a>
                <a href="#" v-if="!selected" @click.stop.prevent="removeWidget()" class="label label-danger">Remove</a>
            </div>
        </div>
    </div>
</template>

<template id="shell-decorator-stub">
    <div class="ge ge-widget">
        <div class="ge ge-content">
            <div
                :is="widget.tag"
                v-ref:widget
                :page.sync="page"
                :data.sync="data"
                :storage.sync="storage"
                :bindings.sync="bindings"
                :children.sync="children"
            ></div>
        </div>
    </div>
</template>

<template id="shell-decorator-vertical">
    <div class="ge ge-widget" :class="{ 'ge-widget-selected': selected, 'ignore-elements': editable }">
        <div class="ge ge-content">
            <div
                :is="widget.tag"
                v-ref:widget
                :page.sync="page"
                :data.sync="data"
                :storage.sync="storage"
                :bindings.sync="bindings"
                :children.sync="children"
                :editable.sync="selected"
            ></div>
        </div>
        <div class="ge ge-overlay" v-if="$route.private && editable">
            <div class="ge ge-overlay-left">
                <a href="#" v-if="!selected" @click.stop.prevent="selectTarget()" class="label label-success">Unlock</a>
                <a href="#" v-if="selected" @click.stop.prevent="unselectTarget()" class="label label-success">Lock</a>
            </div>
            <div class="ge ge-overlay-right">
                <a href="#" v-if="!selected" @click.stop.prevent="showSettings()" class="label label-primary">Settings</a>
                <a href="#" v-if="!selected" @click.stop.prevent="removeWidget()" class="label label-danger">Remove</a>
            </div>
        </div>
    </div>
</template>

<template id="shell-decorator-widget">
    <div class="ge ge-widget">
        <div class="ge ge-content">
            <div
                :is="widget.tag"
                v-ref:widget
                :page.sync="page"
                :data.sync="data"
                :storage.sync="storage"
                :bindings.sync="bindings"
                :children.sync="children"
            ></div>
        </div>
        <div class="ge ge-overlay" v-if="$route.private && editable">
            <div class="ge ge-overlay-right">
                <a href="#" v-if="editable" @click.stop.prevent="showSettings()" class="label label-primary">Settings</a>
                <a href="#" v-if="editable" @click.stop.prevent="removeWidget()" class="label label-danger">Remove</a>
            </div>
        </div>
    </div>
</template>

<template id="shell-domains">
    <section class="ge ge-panel ge-domains">
        <domains :items.sync="domains" :globals.sync="globals" inline-template>
            <h5>
                <span>Domains</span>
                <span class="ge ge-overlays">
                    <span class="ge ge-overlay" @click="create({ title: {}, resource: { params: [] }})"><span class="glyphicon glyphicon-plus-sign"></span></span>
                </span>
            </h5>
            <ul class="nav nav-pills nav-stacked">
                <li v-for="item in items" v-show="item._action != 'remove'" :class="{ 'active': item == globals.selection.domain }">
                    <a href="#" @click="trigger('selectDomain', item)">
                        <span>{{ item.name }}</span>
                        <span class="ge ge-overlays">
                            <span class="ge ge-overlay" @click.stop="remove(item)"><span class="glyphicon glyphicon-trash"></span></span>
                            <span class="ge ge-overlay" @click.stop="update(item)"><span class="glyphicon glyphicon-edit"></span></span>
                        </span>
                    </a>
                </li>
            </ul>
        </domains>
    </section>
</template>

<template id="shell-loader">
    <div class="ge ge-shell-loader">
        <shell-private v-if="portal != null"
            :settings="settings"
            :model="portal"
        ></shell-private>
    </div>
</template>

<template id="shell-pages">
    <section class="ge ge-panel ge-pages">
        <pages :items.sync="pages" :globals.sync="globals" inline-template>
            <h5>
                <span>Pages</span>
                <span class="ge ge-overlays">
                    <span class="ge ge-overlay" @click="create({ title: {}, resource: { params: [] }, sources: [], storages: [], widgets: [], metas: []})"><span class="glyphicon glyphicon-plus-sign"></span></span>
                </span>
            </h5>
            <ul class="nav nav-pills nav-stacked">
                <li v-for="item in items" v-show="item._action != 'remove'" :class="{ 'active': item == globals.selection.page }">
                    <a href="#" @click="trigger('selectPage', item)">
                        <span v-if="item.name != ''">{{ item.name }}</span>
                        <span v-if="item.name == ''"><i>default</i></span>
                        <span class="ge ge-overlays">
                            <span v-if="item.name != ''" class="ge ge-overlay" @click.stop="remove(item)"><span class="glyphicon glyphicon-trash"></span></span>
                            <span class="ge ge-overlay" @click.stop="update(item)"><span class="glyphicon glyphicon-edit"></span></span>
                        </span>
                    </a>
                </li>
            </ul>
        </pages>
    </section>
</template>

<template id="shell-page">

    <div class="ge ge-page" :style="{
        'width': pageSettings.width,
    }">
        <div
            :is="decorator"
            :globals.sync="globals"
            :settings.sync="settings"
            :page.sync="page"
            :data.sync="data"
            :storage.sync="storage"
            :items.sync="page.widgets"
        ></div>
    </div>

</template>

<template id="shell-palette-item">
    <div class="ge ge-palette-item">
        <div data-widget="{{ widget.id }}">
            <img class="when-in-palette" :src="thumbnail" />
        </div>
    </div>
</template>

<template id="shell-palette">
    <section class="ge ge-palette">
        <div class="ge ge-palette-selector">
            <div class="dropdown">
                <button class="btn btn-palette dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                    {{ globals.selection.category.title }} <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li v-for="category in categories"><a @click.prevent="trigger('selectCategory', category)">{{ category.title }}</a></li>
                </ul>
            </div>
        </div>
        <div class="ge ge-palette-categories" v-scrollable>
            <div v-for="c in category.categories" class="ge ge-palette-category">
                <div class="ge ge-category-title">{{ c.title }}</div>
                <div class="ge ge-category-palette">
                    <palette-item v-for="widget in c.widgets" :widget.sync="widget"></palette-item>
                </div>
            </div>
        </div>
    </section>
</template>

<template id="shell-private">
    <div class="ge ge-shell ge-shell-private">
        <div class="ge ge-head">
            <shell-brand
                :model.sync="model"
                :globals.sync="globals"
            ></shell-brand>
        </div>
        <div class="ge ge-body">
            <div class="ge ge-body-table">
                <div class="ge ge-nav">
                    <div class="ge ge-hover">
                        <div class="ge ge-hover-button">
                            <span class="glyphicon glyphicon-th"></span>
                            Palette
                        </div>
                    </div>
                    <div class="ge ge-subnav">
                        <shell-palette
                            :categories.sync="settings.categories"
                            :category.sync="globals.selection.category"
                            :globals.sync="globals"
                        ></shell-palette>
                    </div>
                </div>
                <div class="ge ge-editor" v-scrollable>
                    <shell-actions
                        :model.sync="model"
                        :globals.sync="globals"
                    ></shell-actions>
                    <shell-container
                        :globals.sync="globals"
                        :settings.sync="settings"
                        :page.sync="globals.selection.page"
                    ></shell-container>
                </div>
                <div class="ge ge-structure" v-scrollable>
                    <shell-pages
                        :pages.sync="model.pages"
                        :globals.sync="globals"
                    ></shell-pages>
                    <shell-sources
                        :sources.sync="globals.selection.page.sources"
                        :globals.sync="globals"
                    ></shell-sources>
                    <shell-storages
                        :storages.sync="globals.selection.page.storages"
                        :globals.sync="globals"
                    ></shell-storages>
                </div>
            </div>
        </div>
        <div class="ge ge-foot">
        </div>
    </div>
</template>

<template id="shell-public">
    <div class="ge ge-shell ge-shell-public">
        <shell-page
            :globals.sync="globals"
            :settings.sync="settings"
            :page.sync="page"
            :items.sync="page.widgets"
        ></shell-page>
    </div>
</template>

<template id="shell-stacked">
    <div class="ge ge-stacked"
        ><shell-widget v-for="item in items" v-if="item._action != 'remove'"
            :globals.sync="globals"
            :settings.sync="settings"
            :stack.sync="page"
            :page.sync="page"
            :data.sync="item"
        ></shell-widget
    ></div>
</template>

<template id="shell-sources">
    <section class="ge ge-panel ge-sources">
        <pages-sources :items.sync="sources" :globals.sync="globals" inline-template>
            <h5>
                <span>Sources</span>
                <span class="ge ge-overlays">
                    <span class="ge ge-overlay" @click="create({ schema: 'petstore', method: 'GET', params: [] })"><span class="glyphicon glyphicon-plus-sign"></span></span>
                </span>
            </h5>
            <ul class="nav nav-pills nav-stacked">
                <li v-for="item in items" v-show="item._action != 'remove'" :class="{ 'active': item == globals.selection.source }">
                    <a href="#" @click="trigger('selectSource', item)">
                        <span>{{ item.name }}</span>
                        <span class="ge ge-overlays">
                            <span class="ge ge-overlay" @click.stop="remove(item)"><span class="glyphicon glyphicon-trash"></span></span>
                            <span class="ge ge-overlay" @click.stop="update(item)"><span class="glyphicon glyphicon-edit"></span></span>
                        </span>
                    </a>
                </li>
            </ul>
        </pages-sources>
    </section>
</template>

<template id="shell-storages">
    <section class="ge ge-panel ge-storages">
        <storages :items.sync="storages" :globals.sync="globals" inline-template>
            <h5>
                <span>Storages</span>
                <span class="ge ge-overlays">
                    <span class="ge ge-overlay" @click="create({ variables: [] })"><span class="glyphicon glyphicon-plus-sign"></span></span>
                </span>
            </h5>
            <ul class="nav nav-pills nav-stacked">
                <li v-for="item in items" v-show="item._action != 'remove'" :class="{ 'active': item == globals.selection.storage }">
                    <a href="#" @click="trigger('selectStorage', item)">
                        <span>{{ item.name }}</span>
                        <span class="ge ge-overlays">
                            <span class="ge ge-overlay" @click.stop="remove(item)"><span class="glyphicon glyphicon-trash"></span></span>
                            <span class="ge ge-overlay" @click.stop="update(item)"><span class="glyphicon glyphicon-edit"></span></span>
                        </span>
                    </a>
                </li>
            </ul>
        </storages>
    </section>
</template>

<template id="shell-stub">
    <div class="ge ge-stub">
        <span>Stub</span>
    </div>
</template>

<template id="shell-target">
    <div class="ge ge-target">
        <span>Drop Here</span>
    </div>
</template>

<template id="shell-widget">
    <div>
        <div
            :is="decorator"
            :globals.sync="globals"
            :settings.sync="settings"
            :page.sync="page"
            :data.sync="data"
            :storage.sync="storage"
            :model.sync="model"
            :widget.sync="widget"
            :editable.sync="editable"
            :items.sync="model.widgets"
        ></div>
    </div>
</template>

<template id="pages-widgets-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog modal-lg">
            <form class="modal-content"
                  @submit.prevent="submit"
                  @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Редактирование виджета</span>
                        <span v-if="!original">Новый виджет</span>
                        <span>&gt;</span>
                        <span v-for="tab in context.widget.tabs" v-if="isActive(tab.name)">{{ tab.title }}</span>
                    </h4>
                </div>
                <div class="modal-body" style="height: 500px;">
                    <div class="row">
                        <div class="col-xs-3">
                            <ul class="nav nav-pills nav-stacked">
                                <li v-for="tab in context.widget.tabs" v-if="hasProps(tab.name)" :class="{ 'active': isActive(tab.name) }"><a href="#" @click="activate(tab.name)">{{ tab.title }}</a></li>
                            </ul>
                        </div>
                        <div class="col-xs-9">
                            <div class="tab-content" style="min-height: 450px; max-height: 450px; overflow: auto;">
                                <div v-for="tab in context.widget.tabs" class="tab-pane" :class="{ 'active': isActive(tab.name) }">
                                    <params :items.sync="items" :globals.sync="globals" :owner.sync="context.widget" :tab="tab.name"></params>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>
<template id="pages-widgets-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Имя</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>
                        <span class="label label-success">{{ item.name }}</span>
                        &nbsp;
                        <span>{{ item.type }}</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item, { widget: getWidget(item) })">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item, { widget: getWidget(item) })">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="pages-widgets">

    <section>

        <div class="input-group">
            <div class="pull-left">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                    <span>Добавить</span>
                    &nbsp;
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li v-for="w in globals.widgets">
                        <a href="#" @click.prevent="create(proto(w), { widget: w })">
                            <span><span class="label label-success">{{ w.id }}</span> {{ w.title }}</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <pages-widgets-list :items.sync="items" :globals.sync="globals"></pages-widgets-list>

    <section>

</template>

<template id="pages-sources-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label label-primary">{{ original.name }}</span>
                        <span v-if="original">&nbsp;Редактирование источника</span>
                        <span v-if="!original">Новый источник</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="pages-sources-dialog-name">Имя</label>
                        <input class="form-control" type="text" id="pages-sources-dialog-name" required="true" v-model="current.name" />
                    </div>
                    <div class="form-group">
                        <label for="pages-sources-dialog-url">URL</label>
                        <div class="input-group">
                            <div class="input-group-btn">
                                <button type="button" id="pages-sources-dialog-method" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                    <span class="label" :class="{
                                        'label-primary': current.method == 'GET',
                                        'label-success': current.method == 'POST',
                                        'label-warning': current.method == 'PUT',
                                        'label-danger': current.method == 'DELETE',
                                    }">{{ current.method }}</span>
                                    &nbsp;
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="#" @click="current.method = 'GET'"><span class="label label-primary">GET</span></a></li>
                                    <li><a href="#" @click="current.method = 'POST'"><span class="label label-success">POST</span></a></li>
                                    <li><a href="#" @click="current.method = 'PUT'"><span class="label label-warning">PUT</span></a></li>
                                    <li><a href="#" @click="current.method = 'DELETE'"><span class="label label-danger">DELETE</span></a></li>
                                </ul>
                            </div>
                            <input class="form-control" type="text" id="pages-sources-dialog-url" v-model="current.url" />
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default">...</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pages-sources-dialog-params">Параметры</label>
                        <div>
                            <pages-sources-params :items.sync="current.params">
                            </pages-sources-params>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success pull-left" @click="check()">Проверить</button>
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="pages-sources-list">
    <section>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th></th>
                    <th style="width: 20%">Имя</th>
                    <th><a class="btn btn-xs btn-primary" @click="create({ schema: 'petstore', method: 'GET', params: [] })">Добавить</a></th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>
                        <span class="label label-success">{{ item.name }}</span>
                        &nbsp;
                        <span>{{ item.url }}</span>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-default" @click="update(item)">Редактировать</a>
                        <a class="btn btn-xs btn-danger" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="pages-sources-params-dialog">
    <div class="ge ge-modal modal modal-center" role="dialog">
        <div class="modal-dialog">
            <form class="modal-content"
                @submit.prevent="submit"
                @reset.prevent="reset"
            >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
                    <h4 class="modal-title">
                        <span v-if="original" class="label" :class="{
                            'label-default': original.in == 'path',
                            'label-success': original.in == 'query',
                            'label-primary': original.in == 'formData',
                        }">{{ original.in }}</span>
                        <span v-if="original">{{ original.name }}</span>
                        <span v-if="original">&nbsp;&gt;&nbsp;Редактирование параметра</span>
                        <span v-if="!original">Новый параметр</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="dialog-pages-sources-params-name">Имя</label>
                        <div class="input-group">
                            <div class="input-group-btn">
                                <button type="button" id="dialog-pages-sources-params-in" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                    <span class="label" :class="{
                                        'label-default': current.in == 'path',
                                        'label-success': current.in == 'query',
                                        'label-primary': current.in == 'formData',
                                    }">{{ current.in }}</span>
                                    &nbsp;
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="#" @click="current.in = 'path'"><span class="label label-default">path</span></a></li>
                                    <li><a href="#" @click="current.in = 'query'"><span class="label label-success">query</span></a></li>
                                    <li><a href="#" @click="current.in = 'formData'"><span class="label label-primary">formData</span></a></li>
                                </ul>
                            </div>
                            <input class="form-control" type="text" id="dialog-pages-sources-params-name" required="true" v-model="current.name" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="dialog-pages-sources-params-value">Значение</label>
                        <div class="input-group">
                            <input class="form-control" type="text" id="dialog-pages-sources-params-value" v-model="current.value" />
                            <div class="input-group-btn">
                                <bindings :model.sync="current" inline-template>
                                    <button type="button" class="btn btn-default" @click="open">...</button>
                                </bindings>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" v-model="current.specified" :disabled="current.required" />
                            Отправлять с запросом
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" v-model="current.required" :disabled="!current.specified" />
                            Обязательный параметр
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="reset" class="btn btn-default">Отменить</button>
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="pages-sources-params-list">
    <section>
        <table class="table table-condensed">
            <tbody>
                <tr v-for="item in items" v-show="item._action != 'remove'">
                    <td>{{ $index + 1 }}</td>
                    <td>
                        <div style="white-space: nowrap">
                            <span class="label" :class="{
                                'label-default': item.in == 'path',
                                'label-success': item.in == 'query',
                                'label-primary': item.in == 'formData',
                            }">{{ item.in }}</span>
                            <span>&nbsp;{{item.name }}</span>
                        </div>
                    </td>
                    <td style="width: 60%">
                        <div class="input-group input-group-sm">
                            <label class="input-group-addon">
                                <input type="checkbox" id="pages-sources-dialog-specified" v-model="item.specified" :disabled="item.required" />
                            </label>
                            <input class="form-control" type="text" id="pages-sources-dialog-value" v-model="item.value" :disabled="!item.specified" />
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default" @click="update(item)">...</button>
                            </div>
                        </div>
                    </td>
                    <td>
                        <a class="btn btn-xs btn-danger pull-right" @click="remove(item)">Удалить</a>
                    </td>
                </tr>
            </tbody>
            <tfoot>
                <th></th>
                <th></th>
                <th></th>
                <th><a class="btn btn-xs btn-primary pull-right" @click="create({ in: 'query', specified: true, required: false })">Добавить</a></th>
            </tfoot>
        </table>
    </section>
</template>

<template id="pages-sources-params">

    <pages-sources-params-list :items.sync="items"></pages-sources-params-list>

</template>

<template id="pages-sources">

    <pages-sources-list :items.sync="items"></pages-sources-list>

</template>
